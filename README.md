# FastSparkStreaming

快速创建一个多计划、多主题、可延展、数据安全的streaming

现已更新2.3版本，实现如下目标：

1.plan分为3+1种模式：byWindow 、byKafkaCache 、byKafkaCache(wait)、foreach

byWindow ：     数据安全度 3，参数少，窗口操作与保存偏移量幂等，但可能丢失批处理数据

byKafkaCache : 数据安全度 4 , 参数较多， 持久化中间结果到kafka，批处理与保存偏移量幂等，但还是可能在传输过程中丢失

byKafkaCache(wait)：数据安全度 5（相当安全），不仅持久化中间结果，而且会等待kafka返回成功，如果保存失败会将失败数据再输出到指定路径（目前仅实现输出到控制台）

foreach : 次要模式，仅提供一个快速创建获取中间结果并使用的plan，只能写入一个最终业务

--ps:数据安全度最高为6，可以保证不仅批处理结果安全，连过程中的各个分区数据也安全，很遗憾我做不出来。

(数据安全度是我编的，不是权威数据)



2.主要模式均支持无限延伸，可以任意变形数据，其中：

​	窗口模式要求在使用plan方法时需要额外指定window操作的参数类型（批处理的最终类型）

​	缓存模式要求最终结果类型为String（因为要把结果持久化到kafka）



3.现在plan可以处理多个主题的数据了，并且每个计划每个主题各自维护自己的偏移量，不会发生冲突，并且每个计划的相同分区的偏移量在一次处理中只会保存一次最大值。



--稍微调整了偏移量的存储路径，因此1版本已经全面废弃，现在的存储路径以主题为核心，可以快速检索出主题的所有订阅者（组名+计划名）



~~--2.2追加新功能，可以在一次缓存模式中追加最终处理业务，省去自己手动创建新连接的部分~~

--2.3收回新功能，原因：一个JVM中只能有一个streamContext，说白了一次启动只能启动一个批处理间隔

--替代方案：追加新方法foreach，提供快速创建消费中间结果的方法。